<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CMA Marketing Agency - Digital Services Enhanced</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            scroll-behavior: smooth;
            font-family: "Poppins", serif;
        }

        body {
            background: linear-gradient(270deg, #000000, #1c1c1c, #2a2a2a, #1c1c1c, #000000);
            background-size: 1000% 1000%;
            animation: gradientShift 15s ease infinite;
            color: white;
            overflow-x: hidden;
        }

        @keyframes gradientShift {
            0% {background-position: 0% 50%;}
            50% {background-position: 100% 50%;}
            100% {background-position: 0% 50%;}
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin-right: auto;
            margin-left: auto;
            padding-right: 15px;
            padding-left: 15px;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 2rem auto;
            max-width: 1200px;
            height: auto;
            padding: 0 1rem;
            flex-wrap: wrap;
        }

        .cmalogoh { 
            width: 100px;
            height: 100px;
        }

        .navigation ul {
            display: flex;
            list-style-type: none;
            gap: 2rem;
            flex-wrap: wrap;
        }

        .navigation a {
            text-decoration: none;
            color: #ffffff;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .navigation a:hover {
            background: linear-gradient(90deg, #d4af37, #ffd700, #fff8dc, #ffd700, #d4af37);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        hr {
            opacity: 10%;
            margin: 0.5rem 0;
        }

        .plan {
            width: 100%;
            max-width: 700px;
            height: auto;
            opacity: 0;
            transform: translateY(30px) scale(0.95);
            animation: planFadeIn 1s ease-out forwards;
            animation-delay: 1s;
        }

        @keyframes planFadeIn {
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .hero {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 5rem auto;
            max-width: 1200px;
            padding: 1rem;
            gap: 2rem;
        }

        .herosup {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .plan1 {
            font-size: 2.5rem;
            color: #ffffff;
            opacity: 0;
            transform: translateX(-30px);
            animation: textSlideIn 1s ease-out forwards;
            animation-delay: 0.5s;
        }

        .Don {
            font-size: 1.5rem;
            background: linear-gradient(90deg, #d4af37, #ffd700, #fff8dc, #ffd700, #d4af37);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            opacity: 0;
            transform: translateX(-30px);
            animation: textSlideIn 1s ease-out forwards;
            animation-delay: 0.8s;
        }

        @keyframes textSlideIn {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .Contactus {
            display: inline-block;
            padding: 13px 24px;
            background: linear-gradient(90deg, #d4af37, #ffd700, #fff8dc, #ffd700, #d4af37);
            color: rgb(0, 0, 0);
            border-radius: 25px;
            text-decoration: none;
            text-shadow: 0px 4px 4px rgba(0, 0, 0, 0);
            transition: all 0.4s ease-in-out;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
            font-weight: bold;
            text-align: center;
        }

        .Contactus:hover {
            color: #fff;
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
            background: linear-gradient(90deg, #ffcc00, #ffd700, #ffb300, #ffd700, #ffcc00);
        }

        .Contactus:hover::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 25px;
            transform: scale(1.5);
            opacity: 0;
            animation: glowEffect 0.4s forwards;
        }

        @keyframes glowEffect {
            0% {
                opacity: 0;
                transform: scale(1.5);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .about {
            padding: 4rem 2rem;
            max-width: 1200px;
            margin: 0 auto 6rem auto;
        }

        .about-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 4rem;
            flex-wrap: wrap;
        }

        .about-text {
            flex: 1;
            min-width: 300px;
            animation: slideInLeft 1s ease forwards;
            font-family: "Poppins", sans-serif;
        }

        .about-text h2 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            background: linear-gradient(90deg, #d4af37, #ffd700, #fff8dc, #ffd700, #d4af37);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .about-text p {
            font-size: 1rem;
            line-height: 1.7;
            color: #dddddd;
            margin-bottom: 1rem;
        }

        .about-text p:hover {
            color: #ffffff;
        }

        .about-image {
            flex: 1;
            min-width: 300px;
            display: flex;
            justify-content: center;
            animation: slideInRight 1s ease forwards;
        }

        .about-image img {
            width: 100%;
            max-width: 400px;
            height: auto;
        }

        @keyframes slideInLeft {
            0% { transform: translateX(-50px); opacity: 0; }
            100% { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideInRight {
            0% { transform: translateX(50px); opacity: 0; }
            100% { transform: translateX(0); opacity: 1; }
        }

        .whatsapp-fixed {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #25d366;
            border-radius: 50%;
            padding: 14px;
            z-index: 9999;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .whatsapp-fixed:hover {
            transform: scale(1.15);
            box-shadow: 0 0 30px #25d366;
        }

        .whatsapp-fixed img {
            width: 30px;
            height: 30px;
            display: block;
        }

        .Ourwork {
            padding: 4rem 2rem;
            max-width: 1200px;
            margin: 0 auto 6rem auto;
        }

        .Our--work {
            display: flex;
            flex-direction: column;
            justify-content: space-around;
            align-items: left;
            margin: 5rem auto;
            max-width: 1200px;
        }

        .our-work-title {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            background: linear-gradient(90deg, #d4af37, #ffd700, #fff8dc, #ffd700, #d4af37);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .projecttitl {
            text-align: center;
            margin-bottom: 3rem;
        }

        .projecttitl h1 {
            font-size: 3rem;
            color: #ffffff;
            text-transform: uppercase;
            position: relative;
            display: inline-block;
        }

        .projecttitl h1::after {
            content: "";
            position: absolute;
            width: 60%;
            height: 4px;
            background-color: #ffffff;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 5px;
        }

        .projects {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 2rem;
            max-width: 1200px;
            margin: 0 auto 4rem;
            padding: 0;
            list-style: none;
        }

        .project-card {
            background: #1c1c1e;
            border-radius: 15px;
            overflow: hidden;
            text-align: center;
            padding: 1.5rem 1rem;
            color: #fff;
            text-decoration: none;
            box-shadow: 0 4px 20px rgba(255, 255, 255, 0.15);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            height: 100%;
        }

        .project-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 10px 25px rgba(255, 255, 255, 0.3);
        }

        .image-wrapper {
            width: 100%;
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border-radius: 10px;
            margin-bottom: 1rem;
            background-color: #29292b;
        }

        .image-wrapper img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            transition: transform 0.4s ease;
        }

        .image-wrapper:hover img {
            transform: scale(1.08);
        }

        .project-card p {
            font-size: 1.2rem;
            font-weight: 600;
            margin-top: 0.5rem;
            color: #ffffff;
        }

        .contact-form {
            padding: 4rem 2rem;
            max-width: 600px;
            margin: 0 auto;
            color: #fff;
        }

        .form-container h2 {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 2rem;
            background: linear-gradient(90deg, #d4af37, #ffd700, #fff8dc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        form {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        input, textarea {
            padding: 1rem;
            border-radius: 8px;
            border: none;
            font-size: 1rem;
            background-color: #2a2a2a;
            color: #fff;
            width: 100%;
        }

        textarea {
            resize: vertical;
            min-height: 120px;
        }

        button {
            padding: 1rem;
            background: linear-gradient(90deg, #d4af37, #ffd700, #fff8dc);
            border: none;
            border-radius: 8px;
            color: #000;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        button:hover {
            background: linear-gradient(90deg, #ffcc00, #ffd700, #ffb300);
        }

        .footer-contact {
            background: #121212;
            padding: 3rem 2rem;
            text-align: center;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1000px;
            margin: 0 auto;
            flex-wrap: wrap;
            gap: 2rem;
        }

        .footer-left p {
            margin: 0.5rem 0;
            font-size: 1.1rem;
            color: #dddddd;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .footer-left i {
            color: #ffd700;
        }

        .footer-right a {
            color: #ffffff;
            font-size: 1.8rem;
            margin: 0 10px;
            transition: transform 0.3s ease, color 0.3s ease;
        }

        .footer-right a:hover {
            color: #ffd700;
            transform: scale(1.2);
        }

        .lang-btn {
            background-color: transparent;
            border: 2px solid #ffd700;
            color: white;
            padding: 0.4rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s ease;
        }

        .lang-btn:hover {
            background-color: #ffd700;
            color: black;
        }

        /* أنماط إشعار الشكر */
        .thank-you-popup, .consultation-popup {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 10000;
            justify-content: center;
            align-items: center;
        }
        
        .thank-you-content, .consultation-content {
            background: linear-gradient(135deg, #1c1c1e, #2a2a2a);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            animation: popup-appear 0.6s ease-out;
            position: relative;
            border: 2px solid #ffd700;
        }
        
        @keyframes popup-appear {
            0% { opacity: 0; transform: scale(0.7) translateY(-50px); }
            100% { opacity: 1; transform: scale(1) translateY(0); }
        }
        
        .thank-you-icon, .consultation-icon {
            font-size: 80px;
            color: #ffd700;
            margin-bottom: 20px;
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-20px); }
            60% { transform: translateY(-10px); }
        }
        
        .thank-you-title, .consultation-title {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #ffd700;
        }
        
        .thank-you-message, .consultation-message {
            font-size: 18px;
            color: #dddddd;
            margin-bottom: 25px;
            line-height: 1.5;
        }
        
        .thank-you-close, .consultation-btn {
            display: inline-block;
            background: linear-gradient(90deg, #d4af37, #ffd700, #fff8dc);
            color: #000;
            padding: 12px 30px;
            border-radius: 30px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            font-size: 16px;
            margin: 0 5px;
        }
        
        .thank-you-close:hover, .consultation-btn:hover {
            background: linear-gradient(90deg, #ffcc00, #ffd700, #ffb300);
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(255, 215, 0, 0.3);
        }

        /* أنماط صفحة الخدمة */
        .service-page {
            display: none;
            padding: 4rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .service-page.active {
            display: block;
        }

        .service-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .service-header h1 {
            font-size: 3rem;
            color: #ffffff;
            background: linear-gradient(90deg, #d4af37, #ffd700, #fff8dc, #ffd700, #d4af37);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
        }

        .service-header p {
            font-size: 1.2rem;
            color: #dddddd;
            max-width: 600px;
            margin: 0 auto;
        }

        .service-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .service-item {
            background: #1c1c1e;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(255, 255, 255, 0.15);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }

        .service-item:hover {
            transform: translateY(-8px);
            box-shadow: 0 10px 25px rgba(255, 255, 255, 0.3);
        }

        .service-item-media {
            width: 100%;
            height: 250px;
            overflow: hidden;
            background-color: #29292b;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .service-item-media img,
        .service-item-media video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.4s ease;
        }

        .service-item:hover .service-item-media img,
        .service-item:hover .service-item-media video {
            transform: scale(1.05);
        }

        .service-item-content {
            padding: 1.5rem;
        }

        .service-item-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 0.5rem;
        }

        .service-item-description {
            font-size: 0.9rem;
            color: #dddddd;
            line-height: 1.5;
        }

        .back-btn {
            display: inline-block;
            margin-bottom: 2rem;
            padding: 0.8rem 2rem;
            background: linear-gradient(90deg, #d4af37, #ffd700, #fff8dc);
            color: #000;
            text-decoration: none;
            border-radius: 25px;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: linear-gradient(90deg, #ffcc00, #ffd700, #ffb300);
            transform: translateY(-2px);
        }

        /* أنماط صفحة تفاصيل المشروع */
        .project-detail-page {
            display: none;
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .project-detail-page.active {
            display: block;
        }

        .project-detail-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .project-detail-header h1 {
            font-size: 2.5rem;
            color: #ffd700;
            margin-bottom: 1rem;
        }

        .project-gallery-container {
            position: relative;
            margin-bottom: 2rem;
        }

        .project-gallery {
            display: flex;
            overflow: hidden;
            border-radius: 15px;
            height: 400px;
            background: #1c1c1e;
        }

        .gallery-slide {
            min-width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.5s ease;
        }

        .gallery-slide img, .gallery-slide video {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .gallery-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 215, 0, 0.8);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            cursor: pointer;
            font-size: 1.2rem;
            color: #000;
            transition: all 0.3s ease;
        }

        .gallery-nav:hover {
            background: #ffd700;
            transform: translateY(-50%) scale(1.1);
        }

        .gallery-nav.prev {
            left: 20px;
        }

        .gallery-nav.next {
            right: 20px;
        }

        .gallery-indicators {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 1rem;
        }

        .gallery-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #666;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .gallery-indicator.active {
            background: #ffd700;
            transform: scale(1.2);
        }

        .project-info {
            background: #1c1c1e;
            padding: 2rem;
            border-radius: 15px;
            margin-bottom: 2rem;
        }

        .project-info h3 {
            color: #ffd700;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }

        .project-contact-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 2rem;
        }

        .contact-btn {
            padding: 0.8rem 2rem;
            background: linear-gradient(90deg, #d4af37, #ffd700, #fff8dc);
            color: #000;
            text-decoration: none;
            border-radius: 25px;
            font-weight: bold;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .contact-btn:hover {
            background: linear-gradient(90deg, #ffcc00, #ffd700, #ffb300);
            transform: translateY(-2px);
        }

        /* أنماط الداش بورد */
        .dashboard-container {
            display: none;
            min-height: 100vh;
            background: linear-gradient(270deg, #000000, #1c1c1c, #2a2a2a, #1c1c1c, #000000);
            background-size: 1000% 1000%;
            animation: gradientShift 15s ease infinite;
        }

        .dashboard-container.active {
            display: block;
        }

        .dashboard-header {
            background: #1c1c1e;
            padding: 1rem 2rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .dashboard-header h1 {
            color: #ffffff;
            background: linear-gradient(90deg, #d4af37, #ffd700, #fff8dc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .dashboard-nav {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .dashboard-nav button {
            background: transparent;
            border: 2px solid #ffd700;
            color: #ffd700;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .dashboard-nav button:hover,
        .dashboard-nav button.active {
            background: #ffd700;
            color: #000;
        }

        .dashboard-content {
            padding: 2rem;
        }

        .dashboard-section {
            display: none;
        }

        .dashboard-section.active {
            display: block;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: #1c1c1e;
            padding: 1.5rem;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.1);
        }

        .stat-card h3 {
            font-size: 2rem;
            color: #ffd700;
            margin-bottom: 0.5rem;
        }

        .stat-card p {
            color: #dddddd;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .form-section {
            background: #1c1c1e;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.1);
        }

        .form-section h3 {
            color: #ffd700;
            margin-bottom: 1rem;
        }

        .admin-form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .admin-form input,
        .admin-form textarea,
        .admin-form select {
            padding: 0.8rem;
            border-radius: 5px;
            border: 1px solid #444;
            background-color: #2a2a2a;
            color: #fff;
        }

        .admin-form button {
            padding: 0.8rem;
            background: linear-gradient(90deg, #d4af37, #ffd700, #fff8dc);
            border: none;
            border-radius: 5px;
            color: #000;
            font-weight: bold;
            cursor: pointer;
        }

        .services-list,
        .works-list,
        .messages-list,
        .consultations-list,
        .visitors-list {
            background: #1c1c1e;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.1);
            margin-top: 2rem;
        }

        .list-item {
            background: #2a2a2a;
            padding: 1rem;
            border-radius: 5px;
            margin-bottom: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .list-item-actions {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .list-item-actions button {
            padding: 0.3rem 0.8rem;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        .edit-btn {
            background: #ffd700;
            color: #000;
        }

        .delete-btn {
            background: #ff4444;
            color: #fff;
        }

        .view-btn {
            background: #4CAF50;
            color: #fff;
        }

        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(270deg, #000000, #1c1c1c, #2a2a2a, #1c1c1c, #000000);
            background-size: 1000% 1000%;
            animation: gradientShift 15s ease infinite;
        }

        .login-form {
            background: #1c1c1e;
            padding: 3rem;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            width: 100%;
            max-width: 400px;
        }

        .login-form h2 {
            text-align: center;
            color: #ffd700;
            margin-bottom: 2rem;
            font-size: 2rem;
        }

        .login-form input {
            width: 100%;
            padding: 1rem;
            margin-bottom: 1rem;
            border: 1px solid #444;
            border-radius: 5px;
            background: #2a2a2a;
            color: #fff;
        }

        .login-form button {
            width: 100%;
            padding: 1rem;
            background: linear-gradient(90deg, #d4af37, #ffd700, #fff8dc);
            border: none;
            border-radius: 5px;
            color: #000;
            font-weight: bold;
            cursor: pointer;
            font-size: 1rem;
        }

        .file-input {
            margin-bottom: 1rem;
        }

        .file-input input[type="file"] {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #444;
            border-radius: 5px;
            background: #2a2a2a;
            color: #fff;
        }

        .chart-container {
            background: #1c1c1e;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.1);
            margin-bottom: 2rem;
        }

        .chart-container h3 {
            color: #ffd700;
            margin-bottom: 1rem;
            text-align: center;
        }

        .chart-wrapper {
            height: 400px;
            position: relative;
        }

        .media-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .media-item {
            position: relative;
            aspect-ratio: 1;
            border-radius: 10px;
            overflow: hidden;
            background: #2a2a2a;
        }

        .media-item img, .media-item video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .media-item .remove-media {
            position: absolute;
            top: 5px;
            right: 5px;
            background: #ff4444;
            color: white;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            cursor: pointer;
            font-size: 12px;
            z-index: 10;
        }

        .video-link-input {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .video-link-input input {
            flex: 1;
        }

        .video-link-input button {
            padding: 0.5rem 1rem;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        /* Aspect Ratio Styles for Video Embeds */
        .embed-responsive {
            position: relative;
            display: block;
            width: 100%;
            padding: 0;
            overflow: hidden;
        }

        .embed-responsive::before {
            content: "";
            display: block;
        }

        .embed-responsive-16by9::before {
            padding-top: 56.25%; /* 16:9 Aspect Ratio */
        }

        .embed-responsive-9by16::before {
            padding-top: 177.77%; /* 9:16 Aspect Ratio for Vertical Videos */
        }
        
        .embed-responsive-1by1::before {
            padding-top: 100%; /* 1:1 Aspect Ratio for Instagram Square */
        }

        .embed-responsive iframe,
        .embed-responsive blockquote,
        .embed-responsive video {
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 0;
        }

        /* TikTok specific style */
        .tiktok-embed {
            max-width: 100% !important;
            min-width: unset !important;
        }

        /* وسائط استعلام للشاشات المختلفة */
        @media (max-width: 767px) {
            .container {
                max-width: 100%;
                padding: 0 15px;
            }
            
            header {
                flex-direction: column;
                gap: 1rem;
                margin: 1rem auto;
                padding: 0 0.5rem;
            }
            
            .navigation ul {
                gap: 1rem;
                justify-content: center;
            }
            
            .hero {
                flex-direction: column;
                text-align: center;
                margin: 2rem auto;
                padding: 1rem;
            }
            
            .herosup {
                align-items: center;
            }
            
            .plan1 {
                font-size: 2rem;
            }
            
            .Don {
                font-size: 1.2rem;
            }
            
            .plan {
                max-width: 100%;
                margin-top: 2rem;
            }
            
            .about {
                padding: 2rem 1rem;
            }
            
            .about-container {
                flex-direction: column;
                gap: 2rem;
            }
            
            .about-text, .about-image {
                min-width: 100%;
            }
            
            .our-work-title {
                font-size: 2rem;
                text-align: center;
            }
            
            .Our--work {
                align-items: center;
                padding: 1rem;
                margin: 2rem auto;
            }
            
            .projecttitl h1 {
                font-size: 2.2rem;
            }
            
            .projects {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .project-card {
                max-width: 100%;
            }
            
            .contact-form {
                padding: 2rem 1rem;
            }
            
            input, textarea {
                padding: 0.8rem;
            }
            
            .footer-content {
                flex-direction: column;
                gap: 1.5rem;
            }
            
            .footer-left p {
                justify-content: center;
            }

            .dashboard-header {
                flex-direction: column;
                gap: 1rem;
            }

            .dashboard-nav {
                flex-wrap: wrap;
                justify-content: center;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .project-contact-buttons {
                flex-direction: column;
                align-items: center;
            }

            .gallery-nav {
                width: 40px;
                height: 40px;
                font-size: 1rem;
            }

            .gallery-nav.prev {
                left: 10px;
            }

            .gallery-nav.next {
                right: 10px;
            }
        }

        /* تحسين الاستجابة للشاشات الصغيرة جداً */
        @media (max-width: 480px) {
            .consultation-content, .thank-you-content {
                padding: 20px;
                margin: 10px;
            }

            .consultation-title, .thank-you-title {
                font-size: 22px;
            }

            .consultation-message, .thank-you-message {
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div id="mainSite">
        <header>
            <img class="cmalogoh" src="SVG/asdgfArtboard 1.svg" alt="cma logo" />
            <nav class="navigation">
                <ul>
                    <li><a href="#about" data-en="About" data-ar="من نحن">About</a></li>
                    <li><a href="#Our-work" data-en="Our work" data-ar="أعمالنا">Our work</a></li>
                    <li><a href="#contactMe" data-en="Contact" data-ar="تواصل معنا">Contact</a></li>
                </ul>
            </nav>
            <button id="langToggle" class="lang-btn">AR</button>
        </header>

        <hr />

        <section class="hero">
            <div class="herosup">
                <h1 class="plan1" data-en="The plane will take off" data-ar="الرحلة ستبدأ الآن">The plane will take off</h1>
                <h1 class="Don" data-en="Don't miss the opportunity and make your business take off" data-ar="لا تفوت الفرصة وخلّي عملك يقلع">Don't miss the opportunity and make your business take off</h1>
                <div class="heroptns">
                    <a class="Contactus" href="https://wa.me/201004435408" target="_blank" data-en="Contact us" data-ar="تواصل معنا">Contact us</a>
                </div>
            </div>
            <img class="plan" src="sss/cmaaa.svg" alt="logocma2" />
        </section>

        <section class="about" id="about">
            <div class="about-container">
                <div class="about-image">
                    <img src="sss/people-taking-part-business-event (1).svg" alt="About CMA" width="600" height="400">
                </div>
                <div class="about-text">
                    <h2 data-en="About CMA" data-ar="من نحن">About CMA</h2>
                    <p data-en="At CMA, we think differently. We believe in bold ideas that turn into real results for brands and content creators."
                       data-ar="في CMA نفكر بشكل مختلف. نؤمن بالأفكار الجريئة التي تتحول إلى نتائج حقيقية للعلامات التجارية وصناع المحتوى.">
                       At CMA, we think differently. We believe in bold ideas that turn into real results for brands and content creators.
                    </p>
                    <p data-en="We're a full-service marketing agency focused on building strong digital presence and delivering the professional image every brand deserves."
                       data-ar="نحن وكالة تسويق متكاملة تركز على بناء حضور رقمي قوي وتقديم الصورة الاحترافية التي تستحقها كل علامة تجارية.">
                       We're a full-service marketing agency focused on building strong digital presence and delivering the professional image every brand deserves.
                    </p>
                    <p data-en="Each project gets a dedicated team to ensure creativity, strategy, and impact—all in one."
                       data-ar="كل مشروع يحصل على فريق مخصص لضمان الإبداع والاستراتيجية والتأثير في آن واحد.">
                       Each project gets a dedicated team to ensure creativity, strategy, and impact—all in one.
                    </p>
                    <p data-en="We manage every account with full focus and professionalism as if it's our only one."
                       data-ar="ندير كل حساب بتركيز واحترافية وكأنه الوحيد لدينا.">
                       We manage every account with full focus and professionalism as if it's our only one.
                    </p>
                </div>
            </div>
        </section>

        <section class="Ourwork" id="Our-work">
            <div class="Our--work">
                <div class="projecttitl">
                    <h1 class="our-work-title" data-en="Our work" data-ar="أعمالنا">Our work</h1>
                </div>

                <ul class="projects" id="servicesGrid">
                    </ul>
            </div>
        </section>

        <section class="contact-form" id="contactMe">
            <div class="form-container">
                <h2 data-en="Contact Us" data-ar="تواصل معنا">Contact Us</h2>
                <form id="contactForm" action="https://formsubmit.co/cmamarketing36@gmail.com" method="POST">
                    <input type="text" name="_honey" style="display:none">
                    <input type="hidden" name="_captcha" value="false">
                    <input type="hidden" name="_subject" value="New form submission from CMA Website">
                    
                    <input type="text" name="name" placeholder="Your Name" required data-placeholder-en="Your Name" data-placeholder-ar="اسمك" />
                    <input type="tel" name="phone" placeholder="Phone Number" required data-placeholder-en="Phone Number" data-placeholder-ar="رقم الهاتف" />
                    <input type="email" name="email" placeholder="Email Address" required data-placeholder-en="Email Address" data-placeholder-ar="البريد الإلكتروني" />
                    <textarea name="message" placeholder="Your Message" required data-placeholder-en="Your Message" data-placeholder-ar="رسالتك"></textarea>
                    <button type="submit" data-en="Send Message" data-ar="إرسال">Send Message</button>
                </form>
            </div>
        </section>

        <section class="footer-contact">
            <div class="footer-content">
                <div class="footer-left">
                    <p><i class="fas fa-envelope"></i> cmamarketing36@gmail.com</p>
                    <p><i class="fas fa-phone-alt"></i> +20 109 479 5739</p>
                    <p><i class="fas fa-phone-alt"></i> +20 100 443 5408</p>
                </div>

                <div class="footer-right">
                    <a href="https://www.facebook.com/cmamarketing36" target="_blank" aria-label="Facebook">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    <a href="https://www.instagram.com/cma_egypt/" target="_blank" aria-label="Instagram">
                        <i class="fab fa-instagram"></i>
                    </a>
                </div>
            </div>
        </section>

        <a href="https://wa.me/201004435408"
           class="whatsapp-fixed"
           target="_blank"
           title="Chat with us on WhatsApp">
           <img src="https://img.icons8.com/ios-filled/50/ffffff/whatsapp--v1.png" alt="WhatsApp" />
        </a>
    </div>

    <div id="photographyPage" class="service-page">
        <a href="#" class="back-btn" onclick="backToHome()">
            <i class="fas fa-arrow-left"></i> <span data-en="Back to Home" data-ar="العودة للرئيسية">العودة للرئيسية</span>
        </a>
        <div class="service-header">
            <h1 data-en="Photography Services" data-ar="خدمات التصوير">Photography Services</h1>
            <p data-en="Professional photography services for all your needs" data-ar="خدمات تصوير احترافية لجميع احتياجاتك">Professional photography services for all your needs</p>
        </div>
        <div class="service-gallery" id="photographyGallery">
            </div>
    </div>

    <div id="videoEditingPage" class="service-page">
        <a href="#" class="back-btn" onclick="backToHome()">
            <i class="fas fa-arrow-left"></i> <span data-en="Back to Home" data-ar="العودة للرئيسية">العودة للرئيسية</span>
        </a>
        <div class="service-header">
            <h1 data-en="Video Editing Services" data-ar="خدمات مونتاج الفيديو">Video Editing Services</h1>
            <p data-en="Professional video editing and motion graphics" data-ar="مونتاج فيديو احترافي وجرافيك متحرك">Professional video editing and motion graphics</p>
        </div>
        <div class="service-gallery" id="videoEditingGallery">
            </div>
    </div>

    <div id="graphicDesignPage" class="service-page">
        <a href="#" class="back-btn" onclick="backToHome()">
            <i class="fas fa-arrow-left"></i> <span data-en="Back to Home" data-ar="العودة للرئيسية">العودة للرئيسية</span>
        </a>
        <div class="service-header">
            <h1 data-en="Graphic Design Services" data-ar="خدمات تصميم الجرافيك">Graphic Design Services</h1>
            <p data-en="Creative graphic design solutions for your business" data-ar="حلول تصميم جرافيك إبداعية لعملك">Creative graphic design solutions for your business</p>
        </div>
        <div class="service-gallery" id="graphicDesignGallery">
            </div>
    </div>

    <div id="projectDetailPage" class="project-detail-page">
        <a href="#" class="back-btn" onclick="backToService()">
            <i class="fas fa-arrow-left"></i> <span data-en="Back to Service" data-ar="العودة للخدمة">العودة للخدمة</span>
        </a>
        
        <div class="project-detail-header">
            <h1 id="projectDetailTitle">Project Title</h1>
        </div>

        <div class="project-gallery-container">
            <div class="project-gallery" id="projectGallery">
                </div>
            <button class="gallery-nav prev" onclick="changeSlide(-1)">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="gallery-nav next" onclick="changeSlide(1)">
                <i class="fas fa-chevron-right"></i>
            </button>
            <div class="gallery-indicators" id="galleryIndicators">
                </div>
        </div>

        <div class="project-info">
            <h3 data-en="Project Details" data-ar="تفاصيل المشروع">تفاصيل المشروع</h3>
            <p id="projectDetailDescription">Project description will appear here</p>
            
            <div class="project-contact-buttons">
                <a href="https://wa.me/201004435408" class="contact-btn" target="_blank">
                    <i class="fab fa-whatsapp"></i>
                    <span data-en="WhatsApp" data-ar="واتساب">واتساب</span>
                </a>
                <a href="tel:+201004435408" class="contact-btn">
                    <i class="fas fa-phone"></i>
                    <span data-en="Call" data-ar="اتصال">اتصال</span>
                </a>
                <a href="mailto:cmamarketing36@gmail.com" class="contact-btn">
                    <i class="fas fa-envelope"></i>
                    <span data-en="Email" data-ar="إيميل">إيميل</span>
                </a>
            </div>
        </div>
    </div>

    <div id="loginContainer" class="login-container" style="display: none;">
        <div class="login-form">
            <h2>تسجيل الدخول</h2>
            <input type="text" id="username" placeholder="اسم المستخدم" required>
            <input type="password" id="password" placeholder="كلمة المرور" required>
            <button onclick="login()">دخول</button>
            <p style="text-align: center; margin-top: 1rem;">
                <a href="#" onclick="backToHome()" style="color: #ffd700; text-decoration: none;">العودة للموقع</a>
            </p>
        </div>
    </div>

    <div id="dashboardContainer" class="dashboard-container">
        <div class="dashboard-header">
            <h1>لوحة التحكم - CMA</h1>
            <div class="dashboard-nav">
                <button onclick="showDashboardSection('overview')" class="active">نظرة عامة</button>
                <button onclick="showDashboardSection('services')">إدارة الخدمات</button>
                <button onclick="showDashboardSection('works')">إدارة الأعمال</button>
                <button onclick="showDashboardSection('messages')">الرسائل</button>
                <button onclick="showDashboardSection('consultations')">الاستشارات</button>
                <button onclick="showDashboardSection('visitors')">الزوار</button>
                <button onclick="showDashboardSection('settings')">الإعدادات</button>
                <button onclick="logout()">تسجيل الخروج</button>
            </div>
        </div>

        <div class="dashboard-content">
            <div id="overviewSection" class="dashboard-section active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3 id="totalServices">0</h3>
                        <p>إجمالي الخدمات</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="totalWorks">0</h3>
                        <p>إجمالي الأعمال</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="totalMessages">0</h3>
                        <p>الرسائل الجديدة</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="totalConsultations">0</h3>
                        <p>طلبات الاستشارة</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="totalVisitors">0</h3>
                        <p>الزوار اليوم</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="totalViews">0</h3>
                        <p>إجمالي المشاهدات</p>
                    </div>
                </div>

                <div class="chart-container">
                    <h3>إحصائيات الأعمال</h3>
                    <div class="chart-wrapper">
                        <canvas id="worksChart" style="height: 400px;"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <h3>إحصائيات الزوار (آخر 7 أيام)</h3>
                    <div class="chart-wrapper">
                        <canvas id="visitorsChart" style="height: 400px;"></canvas>
                    </div>
                </div>
            </div>

            <div id="servicesSection" class="dashboard-section">
                <div class="form-section">
                    <h3>إضافة خدمة جديدة</h3>
                    <form class="admin-form" id="addServiceForm">
                        <input type="text" id="serviceName" name="serviceName" placeholder="اسم الخدمة" required>
                        <input type="text" id="serviceNameEn" name="serviceNameEn" placeholder="اسم الخدمة بالإنجليزية" required>
                        <textarea id="serviceDescription" name="serviceDescription" placeholder="وصف الخدمة" required></textarea>
                        <textarea id="serviceDescriptionEn" name="serviceDescriptionEn" placeholder="وصف الخدمة بالإنجليزية" required></textarea>
                        <div class="file-input">
                            <label>صورة الخدمة:</label>
                            <input type="file" id="serviceImage" accept="image/*" required>
                        </div>
                        <button type="submit">إضافة الخدمة</button>
                    </form>
                </div>

                <div class="services-list">
                    <h3>الخدمات الحالية</h3>
                    <div id="servicesList">
                        </div>
                </div>
            </div>

            <div id="worksSection" class="dashboard-section">
                <div class="form-section">
                    <h3 id="workFormTitle">إضافة عمل جديد</h3>
                    <form class="admin-form" id="addWorkForm">
                        <select id="workService" name="workService" required>
                            <option value="">اختر الخدمة</option>
                        </select>
                        <input type="text" id="workTitle" name="workTitle" placeholder="عنوان العمل" required>
                        <input type="text" id="workTitleEn" name="workTitleEn" placeholder="عنوان العمل بالإنجليزية" required>
                        <textarea id="workDescription" name="workDescription" placeholder="وصف العمل" required></textarea>
                        <textarea id="workDescriptionEn" name="workDescriptionEn" placeholder="وصف العمل بالإنجليزية" required></textarea>
                        
                        <div class="file-input">
                            <label>الصور:</label>
                            <input type="file" id="workImages" accept="image/*" multiple>
                        </div>
                        
                        <div class="video-link-input">
                            <input type="url" id="videoLinkInput" placeholder="رابط الفيديو (يوتيوب، انستجرام، تيك توك)">
                            <button type="button" onclick="addVideoLink()">إضافة فيديو</button>
                        </div>
                        
                        <div id="mediaPreview" class="media-grid">
                            </div>
                        
                        <button type="submit" id="addWorkButton">إضافة العمل</button>
                        <button type="button" id="cancelEditButton" style="display: none; background: #666;" onclick="cancelEditWork()">إلغاء التعديل</button>
                    </form>
                </div>

                <div class="works-list">
                    <h3>الأعمال الحالية</h3>
                    <input type="text" id="workFilterInput" placeholder="بحث في الأعمال..." style="margin-bottom: 1rem;">
                    <div id="worksList">
                        </div>
                </div>
            </div>

            <div id="messagesSection" class="dashboard-section">
                <div class="messages-list">
                    <h3>رسائل العملاء</h3>
                    <div id="messagesList">
                        </div>
                </div>
            </div>

            <div id="consultationsSection" class="dashboard-section">
                <div class="consultations-list">
                    <h3>طلبات الاستشارة التسويقية</h3>
                    <div id="consultationsList">
                        </div>
                </div>
            </div>

            <div id="visitorsSection" class="dashboard-section">
                <div class="visitors-list">
                    <h3>تفاصيل الزوار</h3>
                    <div id="visitorsList">
                        </div>
                </div>
            </div>

            <div id="settingsSection" class="dashboard-section">
                <div class="form-section">
                    <h3>تغيير كلمة المرور</h3>
                    <form class="admin-form" id="changePasswordForm">
                        <input type="password" id="currentPassword" placeholder="كلمة المرور الحالية" required>
                        <input type="password" id="newPassword" placeholder="كلمة المرور الجديدة" required>
                        <input type="password" id="confirmPassword" placeholder="تأكيد كلمة المرور الجديدة" required>
                        <button type="submit">تغيير كلمة المرور</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="thank-you-popup" id="thankYouPopup">
        <div class="thank-you-content">
            <i class="fas fa-check-circle thank-you-icon"></i>
            <h2 class="thank-you-title" data-en="Thank You!" data-ar="شكراً لك!">Thank You!</h2>
            <p class="thank-you-message" data-en="Your message has been sent successfully. We'll contact you soon." data-ar="تم إرسال رسالتك بنجاح. سنتواصل معك قريباً.">Your message has been sent successfully. We'll contact you soon.</p>
            <button class="thank-you-close" id="closeThankYou" data-en="Close" data-ar="إغلاق">Close</button>
        </div>
    </div>

    <div class="consultation-popup" id="consultationPopup">
        <div class="consultation-content">
            <i class="fas fa-lightbulb consultation-icon"></i>
            <h2 class="consultation-title" data-en="Get Free Marketing Consultation!" data-ar="احصل على استشارة تسويقية مجانية!">احصل على استشارة تسويقية مجانية!</h2>
            <form id="consultationForm" style="display: flex; flex-direction: column; gap: 1rem; margin-top: 1rem; margin-bottom: 1.5rem;">
                <input type="text" name="consultationName" required
                       data-en="Your Name" data-ar="اسمك"
                       data-placeholder-en="Your Name" data-placeholder-ar="اسمك"
                       placeholder="Your Name"
                       style="padding: 1rem; border-radius: 8px; border: 1px solid #444; font-size: 1rem; background-color: #2a2a2a; color: #fff; width: 100%;">
                <input type="tel" name="consultationPhone" required
                       data-en="Phone Number" data-ar="رقم الهاتف"
                       data-placeholder-en="Phone Number" data-placeholder-ar="رقم الهاتف"
                       placeholder="Phone Number"
                       style="padding: 1rem; border-radius: 8px; border: 1px solid #444; font-size: 1rem; background-color: #2a2a2a; color: #fff; width: 100%;">
                <input type="email" name="consultationEmail" required
                       data-en="Email Address" data-ar="البريد الإلكتروني"
                       data-placeholder-en="Email Address" data-placeholder-ar="البريد الإلكتروني"
                       placeholder="Email Address"
                       style="padding: 1rem; border-radius: 8px; border: 1px solid #444; font-size: 1rem; background-color: #2a2a2a; color: #fff; width: 100%;">
                <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                    <button type="submit" class="consultation-btn" data-en="Book Now" data-ar="احجز الآن">احجز الآن</button>
                    <button type="button" class="consultation-btn" onclick="closeConsultationPopup()" data-en="Maybe Later" data-ar="ربما لاحقاً">ربما لاحقاً</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // متغيرات عامة
        let currentLanguage = 'en';
        let isLoggedIn = false;
        let currentUser = null;
        let worksChart = null;
        let visitorsChart = null;
        let currentProjectDetail = null;
        let currentServicePage = '';
        let currentSlide = 0;
        let videoLinks = [];
        let currentlyEditingWorkId = null;

        // بيانات افتراضية للنظام
        const defaultData = {
            services: [
                {
                    id: 'photography',
                    name: 'التصوير',
                    nameEn: 'Photography',
                    description: 'خدمات تصوير احترافية لجميع احتياجاتك',
                    descriptionEn: 'Professional photography services for all your needs',
                    image: 'sss/Content Management IM.svg'
                },
                {
                    id: 'video-editing',
                    name: 'مونتاج الفيديو',
                    nameEn: 'Video Editing',
                    description: 'مونتاج فيديو احترافي وجرافيك متحرك',
                    descriptionEn: 'Professional video editing and motion graphics',
                    image: 'sss/social-media-concept-with-smartphone.svg'
                },
                {
                    id: 'graphic-design',
                    name: 'تصميم الجرافيك',
                    nameEn: 'Graphic Design',
                    description: 'حلول تصميم جرافيك إبداعية لعملك',
                    descriptionEn: 'Creative graphic design solutions for your business',
                    image: 'sss/تעديل فيديو.svg'
                }
            ],
            works: [
                {
                    id: 1,
                    service: 'photography',
                    title: 'تصوير منتجات تجارية',
                    titleEn: 'Commercial Product Photography',
                    description: 'تصوير احترافي للمنتجات التجارية بجودة عالية',
                    descriptionEn: 'Professional high-quality commercial product photography',
                    media: ['sss/تصوير.svg'],
                    videos: []
                },
                {
                    id: 2,
                    service: 'video-editing',
                    title: 'مونتاج إعلان تجاري',
                    titleEn: 'Commercial Video Editing',
                    description: 'مونتاج إعلان تجاري احترافي مع مؤثرات بصرية',
                    descriptionEn: 'Professional commercial video editing with visual effects',
                    media: [],
                    videos: ['https://www.youtube.com/watch?v=dQw4w9WgXcQ']
                },
                {
                    id: 3,
                    service: 'graphic-design',
                    title: 'تصميم هوية بصرية',
                    titleEn: 'Brand Identity Design',
                    description: 'تصميم هوية بصرية متكاملة للشركات',
                    descriptionEn: 'Complete brand identity design for businesses',
                    media: ['sss/تعديل فيديو.svg'],
                    videos: []
                }
            ],
            messages: [],
            consultations: [],
            visitors: [],
            users: [{
                username: 'admin',
                password: 'cma2024'
            }]
        };

        // تهيئة النظام
        function initializeSystem() {
            // تحميل البيانات من localStorage أو استخدام البيانات الافتراضية
            if (!localStorage.getItem('cmaData')) {
                localStorage.setItem('cmaData', JSON.stringify(defaultData));
            }
            
            // تسجيل زائر جديد
            trackVisitor();
            
            // تحميل الخدمات
            loadServices();
            
            // إظهار إشعار الاستشارة بعد 30 ثانية
            setTimeout(showConsultationPopup, 30000);
            
            // تحديث الإحصائيات
            updateStats();

            // التحقق من URL للداش بورد
            checkDashboardAccess();
        }

        // تتبع الزوار
        function trackVisitor() {
            const data = JSON.parse(localStorage.getItem('cmaData'));
            const now = new Date();
            const today = now.toDateString();
            
            // البحث عن زائر اليوم
            let todayVisitor = data.visitors.find(v => v.date === today);
            
            if (todayVisitor) {
                todayVisitor.count++;
                todayVisitor.lastVisit = now.toISOString();
            } else {
                data.visitors.push({
                    date: today,
                    count: 1,
                    lastVisit: now.toISOString(),
                    userAgent: navigator.userAgent,
                    language: navigator.language
                });
            }
            
            localStorage.setItem('cmaData', JSON.stringify(data));
        }

        // التحقق من الوصول للداش بورد
        function checkDashboardAccess() {
            const path = window.location.pathname;
            const hash = window.location.hash;
            
            if (path.endsWith('/XCMA') || hash === '#XCMA') {
                showLogin();
            }
        }

        // تبديل اللغة
        document.getElementById('langToggle').addEventListener('click', function () {
            const isArabic = this.innerText === 'AR';
            const elements = document.querySelectorAll('[data-en]');
        
            elements.forEach(el => {
                const newText = isArabic ? el.getAttribute('data-ar') : el.getAttribute('data-en');
                if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
                    // للحقول النصية، استخدم placeholder
                    const placeholderAr = el.getAttribute('data-placeholder-ar');
                    const placeholderEn = el.getAttribute('data-placeholder-en');
                    if (placeholderAr && placeholderEn) {
                        el.placeholder = isArabic ? placeholderAr : placeholderEn;
                    }
                } else {
                    el.textContent = newText;
                }
            });
        
            this.innerText = isArabic ? 'EN' : 'AR';
            document.documentElement.setAttribute("lang", isArabic ? "ar" : "en");
            document.body.style.direction = isArabic ? "rtl" : "ltr";
            currentLanguage = isArabic ? 'ar' : 'en';

            // تحديث النصوص في الصفحات المختلفة
            updatePageTexts();
        });

        // تحديث النصوص في الصفحات
        function updatePageTexts() {
            // تحديث نصوص الخدمات
            loadServices();
            
            // تحديث نصوص الأعمال إذا كانت مفتوحة
            if (currentServicePage) {
                loadServiceWorks(currentServicePage);
            }
            
            // تحديث نصوص تفاصيل المشروع إذا كانت مفتوحة
            if (currentProjectDetail) {
                showProjectDetail(currentProjectDetail);
            }
        }

        // معالجة إرسال النموذج
        document.getElementById('contactForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const form = this;
            const formData = new FormData(form);
            const submitButton = form.querySelector('button[type="submit"]');
            const originalButtonText = submitButton.textContent;
            
            // حفظ الرسالة محلياً
            const message = {
                id: Date.now(),
                name: formData.get('name'),
                phone: formData.get('phone'),
                email: formData.get('email'),
                message: formData.get('message'),
                date: new Date().toISOString(),
                read: false
            };
            
            const data = JSON.parse(localStorage.getItem('cmaData'));
            data.messages.push(message);
            localStorage.setItem('cmaData', JSON.stringify(data));
            
            // تغيير نص الزر أثناء الإرسال
            const loadingText = currentLanguage === 'ar' ? 'جارِ الإرسال...' : 'Sending...';
            submitButton.textContent = loadingText;
            submitButton.disabled = true;
            
            // إرسال بيانات النموذج
            fetch(form.action, {
                method: 'POST',
                body: formData,
                headers: {
                    'Accept': 'application/json'
                }
            })
            .then(response => {
                document.getElementById('thankYouPopup').style.display = 'flex';
                form.reset();
                updateStats();
            })
            .catch(error => {
                document.getElementById('thankYouPopup').style.display = 'flex';
                form.reset();
                updateStats();
            })
            .finally(() => {
                submitButton.textContent = originalButtonText;
                submitButton.disabled = false;
            });
        });

        // إظهار إشعار الاستشارة
        function showConsultationPopup() {
            // عدم إظهار الإشعار في الداش بورد
            if (document.getElementById('dashboardContainer').classList.contains('active') || 
                document.getElementById('loginContainer').style.display !== 'none') {
                return;
            }
            
            // عدم إظهار الإشعار إذا تم طلب استشارة من قبل
            if (localStorage.getItem('consultationRequested') === 'true') {
                return;
            }
            
            document.getElementById('consultationPopup').style.display = 'flex';
        }

        // إرسال إيميل الاستشارة
        function sendConsultationEmail(consultation) {
            const subject = 'طلب استشارة تسويقية جديد - CMA';
            const body = `
طلب استشارة تسويقية جديد:

الاسم: ${consultation.name}
الهاتف: ${consultation.phone}
البريد الإلكتروني: ${consultation.email}
التاريخ: ${new Date(consultation.date).toLocaleString('ar-EG')}

يرجى التواصل مع العميل في أقرب وقت ممكن.
            `;
            
            // إرسال الإيميل باستخدام FormSubmit
            const formData = new FormData();
            formData.append('_subject', subject);
            formData.append('name', consultation.name);
            formData.append('phone', consultation.phone);
            formData.append('email', consultation.email);
            formData.append('message', 'طلب استشارة تسويقية مجانية');
            formData.append('_honey', '');
            formData.append('_captcha', 'false');
            
            fetch('https://formsubmit.co/cmamarketing36@gmail.com', {
                method: 'POST',
                body: formData
            }).catch(error => console.log('Email sending error:', error));
        }

        // إغلاق إشعار الاستشارة
        function closeConsultationPopup() {
            document.getElementById('consultationPopup').style.display = 'none';
        }

        // إغلاق إشعار الشكر
        document.getElementById('closeThankYou').addEventListener('click', function() {
            document.getElementById('thankYouPopup').style.display = 'none';
        });

        document.getElementById('thankYouPopup').addEventListener('click', function(e) {
            if (e.target === this) {
                this.style.display = 'none';
            }
        });

        // إغلاق إشعار الاستشارة عند النقر خارجه
        document.getElementById('consultationPopup').addEventListener('click', function(e) {
            if (e.target === this) {
                closeConsultationPopup();
            }
        });

        // عرض صفحة الخدمة
        function showService(serviceId) {
            const pages = document.querySelectorAll('.service-page');
            pages.forEach(page => page.classList.remove('active'));
            
            document.getElementById('mainSite').style.display = 'none';
            
            currentServicePage = serviceId;
            let pageId;
            switch(serviceId) {
                case 'photography':
                    pageId = 'photographyPage';
                    break;
                case 'video-editing':
                    pageId = 'videoEditingPage';
                    break;
                case 'graphic-design':
                    pageId = 'graphicDesignPage';
                    break;
                default:
                    // للخدمات المضافة حديثاً
                    pageId = 'photographyPage'; // استخدام صفحة افتراضية
                    break;
            }
            
            document.getElementById(pageId).classList.add('active');
            loadServiceWorks(serviceId);
        }

        // تحميل أعمال الخدمة
        function loadServiceWorks(serviceId) {
            const data = JSON.parse(localStorage.getItem('cmaData'));
            const works = data.works.filter(work => work.service === serviceId);
            
            let galleryId;
            switch(serviceId) {
                case 'photography':
                    galleryId = 'photographyGallery';
                    break;
                case 'video-editing':
                    galleryId = 'videoEditingGallery';
                    break;
                case 'graphic-design':
                    galleryId = 'graphicDesignGallery';
                    break;
                default:
                    galleryId = 'photographyGallery';
                    break;
            }
            
            const gallery = document.getElementById(galleryId);
            if (!gallery) return;
            
            gallery.innerHTML = '';
            
            works.forEach(work => {
                const workElement = document.createElement('div');
                workElement.className = 'service-item';
                workElement.onclick = () => showProjectDetail(work);
                
                // استخدام أول وسيط متاح
                let mediaElement = '';
                if (work.media && work.media.length > 0) {
                    mediaElement = `<img src="${work.media[0]}" alt="${work.title}">`;
                } else if (work.videos && work.videos.length > 0) {
                    const videoUrl = work.videos[0];
                    mediaElement = generateEmbedHtml(videoUrl);
                } else {
                    mediaElement = `<div style="display: flex; align-items: center; justify-content: center; color: #666;">
                        <i class="fas fa-image" style="font-size: 3rem;"></i>
                    </div>`;
                }
                
                workElement.innerHTML = `
                    <div class="service-item-media">
                        ${mediaElement}
                    </div>
                    <div class="service-item-content">
                        <h3 class="service-item-title">${currentLanguage === 'ar' ? work.title : work.titleEn}</h3>
                        <p class="service-item-description">${currentLanguage === 'ar' ? work.description : work.descriptionEn}</p>
                    </div>
                `;
                
                gallery.appendChild(workElement);
            });
            
            if (works.length === 0) {
                gallery.innerHTML = `
                    <div style="text-align: center; color: #666; padding: 2rem; grid-column: 1 / -1;">
                        <i class="fas fa-folder-open" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                        <p>${currentLanguage === 'ar' ? 'لا توجد أعمال متاحة في هذه الخدمة حالياً' : 'No works available in this service currently'}</p>
                    </div>
                `;
            }
        }

        // عرض تفاصيل المشروع
        function showProjectDetail(work) {
            currentProjectDetail = work;
            
            // إخفاء جميع الصفحات
            document.getElementById('mainSite').style.display = 'none';
            document.getElementById('dashboardContainer').classList.remove('active');
            const servicePages = document.querySelectorAll('.service-page');
            servicePages.forEach(page => page.classList.remove('active'));
            
            // إظهار صفحة التفاصيل
            const detailPage = document.getElementById('projectDetailPage');
            detailPage.classList.add('active');
            
            // تحديث المحتوى
            document.getElementById('projectDetailTitle').textContent = 
                currentLanguage === 'ar' ? work.title : work.titleEn;
            document.getElementById('projectDetailDescription').textContent = 
                currentLanguage === 'ar' ? work.description : work.descriptionEn;
            
            // إنشاء معرض الصور والفيديوهات
            createProjectGallery(work);
        }

        // إنشاء معرض المشروع
        function createProjectGallery(work) {
            const gallery = document.getElementById('projectGallery');
            const indicators = document.getElementById('galleryIndicators');
            
            gallery.innerHTML = '';
            indicators.innerHTML = '';
            
            const allMedia = [];
            
            // إضافة الصور
            if (work.media) {
                work.media.forEach(media => {
                    allMedia.push({type: 'image', src: media});
                });
            }
            
            // إضافة الفيديوهات
            if (work.videos) {
                work.videos.forEach(video => {
                    allMedia.push({type: 'video', src: video});
                });
            }
            
            if (allMedia.length === 0) {
                gallery.innerHTML = `
                    <div class="gallery-slide" style="display: flex; align-items: center; justify-content: center; color: #666;">
                        <div style="text-align: center;">
                            <i class="fas fa-image" style="font-size: 4rem; margin-bottom: 1rem;"></i>
                            <p>لا توجد وسائط متاحة</p>
                        </div>
                    </div>
                `;
                return;
            }
            
            allMedia.forEach((media, index) => {
                const slide = document.createElement('div');
                slide.className = 'gallery-slide';
                
                if (media.type === 'image') {
                    slide.innerHTML = `<img src="${media.src}" alt="Project Image">`;
                } else { // It's a video
                    slide.innerHTML = generateEmbedHtml(media.src);
                }
                
                gallery.appendChild(slide);
                
                // إنشاء مؤشر
                const indicator = document.createElement('div');
                indicator.className = 'gallery-indicator';
                if (index === 0) indicator.classList.add('active');
                indicator.onclick = () => goToSlide(index);
                indicators.appendChild(indicator);
            });
            
            currentSlide = 0;
            updateGalleryDisplay();
        }

        // Helper function to load external scripts
        function loadScript(src, id) {
            if (document.getElementById(id)) return; // Script already loaded
            const script = document.createElement('script');
            script.src = src;
            script.id = id;
            script.async = true;
            document.head.appendChild(script);
        }
    
        // New function to generate embed HTML for various platforms
        function generateEmbedHtml(url) {
            let embedHtml = '';
    
            // YouTube
            const youtubeRegex = /(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/|youtube\.com\/shorts\/)([^"&?\/ ]{11})/;
            const youtubeMatch = url.match(youtubeRegex);
            if (youtubeMatch && youtubeMatch[1]) {
                const videoId = youtubeMatch[1];
                const isShort = url.includes('/shorts/');
                const aspectRatioClass = isShort ? 'embed-responsive-9by16' : 'embed-responsive-16by9';
                embedHtml = `
                    <div class="embed-responsive ${aspectRatioClass}">
                        <iframe src="https://www.youtube.com/embed/$${videoId}" 
                                frameborder="0" 
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                allowfullscreen>
                        </iframe>
                    </div>`;
                return embedHtml;
            }
    
            // Instagram
            const instagramRegex = /https:\/\/(?:www\.)?instagram\.com\/(p|reel)\/([a-zA-Z0-9_-]+)/;
            const instagramMatch = url.match(instagramRegex);
            if (instagramMatch && instagramMatch[2]) {
                const shortcode = instagramMatch[2];
                const isReel = instagramMatch[1] === 'reel';
                const aspectRatioClass = isReel ? 'embed-responsive-9by16' : 'embed-responsive-1by1';
                loadScript('//www.instagram.com/embed.js', 'instagram-embed-script');
                embedHtml = `
                    <div class="embed-responsive ${aspectRatioClass}">
                         <blockquote class="instagram-media"
                                     data-instgrm-permalink="https://www.instagram.com/p/${shortcode}/?utm_source=ig_embed"
                                     data-instgrm-version="14"
                                     style="width: 100%; height: 100%; margin: 0;">
                         </blockquote>
                    </div>`;
                 // Instagram's script will handle the content loading.
                return embedHtml;
            }
    
            // TikTok
            const tiktokRegex = /https:\/\/(?:www\.|vm\.)?tiktok\.com\/.*\/video\/(\d+)/;
            const tiktokMatch = url.match(tiktokRegex);
            if (tiktokMatch && tiktokMatch[1]) {
                const videoId = tiktokMatch[1];
                loadScript('https://www.tiktok.com/embed.js', 'tiktok-embed-script');
                // TikTok blockquote is responsive by nature but we wrap it for consistency and to control aspect ratio.
                embedHtml = `
                    <div class="embed-responsive embed-responsive-9by16">
                        <blockquote class="tiktok-embed"
                                    cite="${url}"
                                    data-video-id="${videoId}"
                                    style="width: 100%; height: 100%; margin: 0;">
                        </blockquote>
                    </div>`;
                return embedHtml;
            }
    
            // Facebook
            const facebookRegex = /https:\/\/(?:www\.)?facebook\.com\/(?:watch\/?\?v=|.*\/videos\/|reel\/)(\d+)/;
            const facebookMatch = url.match(facebookRegex);
            if (facebookMatch) {
                const encodedUrl = encodeURIComponent(url);
                const isReel = url.includes('/reel/');
                const aspectRatioClass = isReel ? 'embed-responsive-9by16' : 'embed-responsive-16by9';
                embedHtml = `
                    <div class="embed-responsive ${aspectRatioClass}" style="overflow: auto;">
                        <iframe src="https://www.facebook.com/plugins/video.php?href=${encodedUrl}&show_text=false&width=560" 
                                style="border:none;overflow:hidden" 
                                scrolling="no" 
                                frameborder="0" 
                                allowfullscreen="true" 
                                allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share">
                        </iframe>
                    </div>`;
                return embedHtml;
            }
    
            // Fallback for direct video links
            embedHtml = `
                <div class="embed-responsive embed-responsive-16by9">
                    <video controls playsinline webkit-playsinline>
                        <source src="${url}" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                </div>`;
            return embedHtml;
        }

        // تغيير الشريحة
        function changeSlide(direction) {
            const slides = document.querySelectorAll('.gallery-slide');
            if (slides.length === 0) return;
            
            currentSlide += direction;
            
            if (currentSlide >= slides.length) {
                currentSlide = 0;
            } else if (currentSlide < 0) {
                currentSlide = slides.length - 1;
            }
            
            updateGalleryDisplay();
        }

        // الذهاب لشريحة محددة
        function goToSlide(index) {
            currentSlide = index;
            updateGalleryDisplay();
        }

        // تحديث عرض المعرض
        function updateGalleryDisplay() {
            const gallery = document.getElementById('projectGallery');
            const indicators = document.querySelectorAll('.gallery-indicator');
            
            if (gallery) {
                gallery.style.transform = `translateX(-${currentSlide * 100}%)`;
            }
            
            indicators.forEach((indicator, index) => {
                indicator.classList.toggle('active', index === currentSlide);
            });
        }

        // العودة للصفحة الرئيسية
        function backToHome() {
            document.getElementById('mainSite').style.display = 'block';
            document.getElementById('loginContainer').style.display = 'none';
            document.getElementById('dashboardContainer').classList.remove('active');
            document.getElementById('projectDetailPage').classList.remove('active');
            
            const pages = document.querySelectorAll('.service-page');
            pages.forEach(page => page.classList.remove('active'));
            
            currentServicePage = '';
            currentProjectDetail = null;
        }

        // العودة للخدمة
        function backToService() {
            document.getElementById('projectDetailPage').classList.remove('active');
            if (currentServicePage) {
                showService(currentServicePage);
            } else if (isLoggedIn) {
                document.getElementById('dashboardContainer').classList.add('active');
            }
            else {
                backToHome();
            }
        }

        // عرض تسجيل الدخول
        function showLogin() {
            document.getElementById('mainSite').style.display = 'none';
            document.getElementById('loginContainer').style.display = 'flex';
        }

        // تسجيل الدخول
        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            const data = JSON.parse(localStorage.getItem('cmaData'));
            const user = data.users.find(u => u.username === username && u.password === password);
            
            if (user) {
                isLoggedIn = true;
                currentUser = user;
                document.getElementById('loginContainer').style.display = 'none';
                document.getElementById('dashboardContainer').classList.add('active');
                loadDashboard();
            } else {
                alert('اسم المستخدم أو كلمة المرور غير صحيحة');
            }
        }

        // تسجيل الخروج
        function logout() {
            isLoggedIn = false;
            currentUser = null;
            backToHome();
        }

        // تحميل الداش بورد
        function loadDashboard() {
            updateStats();
            loadServices();
            loadWorks();
            loadMessages();
            loadConsultations();
            loadVisitors();
            createCharts();
            document.getElementById('workFilterInput').addEventListener('input', filterWorks);
        }

        // عرض قسم الداش بورد
        function showDashboardSection(section) {
            // إخفاء جميع الأقسام
            const sections = document.querySelectorAll('.dashboard-section');
            sections.forEach(s => s.classList.remove('active'));
            
            // إزالة الفئة النشطة من جميع الأزرار
            const buttons = document.querySelectorAll('.dashboard-nav button');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            // عرض القسم المحدد
            document.getElementById(section + 'Section').classList.add('active');
            
            // تفعيل الزر المحدد
            event.target.classList.add('active');
        }

        // تحديث الإحصائيات
        function updateStats() {
            const data = JSON.parse(localStorage.getItem('cmaData'));
            
            const totalServicesEl = document.getElementById('totalServices');
            const totalWorksEl = document.getElementById('totalWorks');
            const totalMessagesEl = document.getElementById('totalMessages');
            const totalConsultationsEl = document.getElementById('totalConsultations');
            const totalVisitorsEl = document.getElementById('totalVisitors');
            const totalViewsEl = document.getElementById('totalViews');
            
            if (totalServicesEl) totalServicesEl.textContent = data.services.length;
            if (totalWorksEl) totalWorksEl.textContent = data.works.length;
            if (totalMessagesEl) totalMessagesEl.textContent = data.messages.filter(m => !m.read).length;
            if (totalConsultationsEl) totalConsultationsEl.textContent = data.consultations.length;
            if (totalVisitorsEl) {
                const today = new Date().toDateString();
                const todayVisitor = data.visitors.find(v => v.date === today);
                totalVisitorsEl.textContent = todayVisitor ? todayVisitor.count : 0;
            }
            if (totalViewsEl) {
                const totalViews = data.visitors.reduce((sum, visitor) => sum + visitor.count, 0);
                totalViewsEl.textContent = totalViews;
            }
        }

        // تحميل الخدمات
        function loadServices() {
            const data = JSON.parse(localStorage.getItem('cmaData'));
            const servicesList = document.getElementById('servicesList');
            const servicesGrid = document.getElementById('servicesGrid');
            const workService = document.getElementById('workService');
            
            // تحديث قائمة الخدمات في الداش بورد
            if (servicesList) {
                servicesList.innerHTML = '';
                data.services.forEach(service => {
                    const serviceElement = document.createElement('div');
                    serviceElement.className = 'list-item';
                    serviceElement.innerHTML = `
                        <div>
                            <strong>${service.name}</strong>
                            <p style="color: #666; font-size: 0.9rem;">${service.description}</p>
                        </div>
                        <div class="list-item-actions">
                            <button class="edit-btn" onclick="editService('${service.id}')">تعديل</button>
                            <button class="delete-btn" onclick="deleteService('${service.id}')">حذف</button>
                        </div>
                    `;
                    servicesList.appendChild(serviceElement);
                });
            }
            
            // تحديث شبكة الخدمات في الصفحة الرئيسية
            if (servicesGrid) {
                servicesGrid.innerHTML = '';
                data.services.forEach(service => {
                    const serviceElement = document.createElement('li');
                    serviceElement.innerHTML = `
                        <a href="#" class="project-card" onclick="showService('${service.id}')">
                            <div class="image-wrapper">
                                <img src="${service.image}" alt="${service.name}" />
                            </div>
                            <p data-en="${service.nameEn}" data-ar="${service.name}">${currentLanguage === 'ar' ? service.name : service.nameEn}</p>
                        </a>
                    `;
                    servicesGrid.appendChild(serviceElement);
                });
            }
            
            // تحديث قائمة اختيار الخدمة في إضافة الأعمال
            if (workService) {
                workService.innerHTML = '<option value="">اختر الخدمة</option>';
                data.services.forEach(service => {
                    const option = document.createElement('option');
                    option.value = service.id;
                    option.textContent = service.name;
                    workService.appendChild(option);
                });
            }
        }
        
        // عرض العمل في الداش بورد
        function viewWorkInDashboard(workId) {
            const data = JSON.parse(localStorage.getItem('cmaData'));
            const work = data.works.find(w => w.id === workId);
            if(work) {
                showProjectDetail(work);
            }
        }
        
        // تعديل العمل
        function editWork(workId) {
            const data = JSON.parse(localStorage.getItem('cmaData'));
            const work = data.works.find(w => w.id === workId);
            if (!work) return;

            currentlyEditingWorkId = workId;

            // ملء النموذج
            document.getElementById('workService').value = work.service;
            document.getElementById('workTitle').value = work.title;
            document.getElementById('workTitleEn').value = work.titleEn;
            document.getElementById('workDescription').value = work.description;
            document.getElementById('workDescriptionEn').value = work.descriptionEn;
            videoLinks = [...(work.videos || [])];
            
            // تحديث واجهة المستخدم لوضع التعديل
            document.getElementById('workFormTitle').textContent = 'تعديل العمل';
            document.getElementById('addWorkButton').textContent = 'تحديث العمل';
            document.getElementById('cancelEditButton').style.display = 'inline-block';

            updateMediaPreview(); // ملاحظة: لا يمكننا إعادة تحميل الصور من base64، سيحتاج المستخدم لإعادة تحديدها إذا أراد تغييرها
            alert('تم تحميل بيانات العمل في النموذج. لإضافة أو تغيير الصور، يرجى تحديدها مرة أخرى.');
        }

        function cancelEditWork() {
            currentlyEditingWorkId = null;
            document.getElementById('addWorkForm').reset();
            videoLinks = [];
            updateMediaPreview();
            document.getElementById('workFormTitle').textContent = 'إضافة عمل جديد';
            document.getElementById('addWorkButton').textContent = 'إضافة العمل';
            document.getElementById('cancelEditButton').style.display = 'none';
        }

        // فلترة الأعمال
        function filterWorks() {
            const filterValue = document.getElementById('workFilterInput').value.toLowerCase();
            const worksList = document.getElementById('worksList');
            const items = worksList.getElementsByClassName('list-item');

            Array.from(items).forEach(item => {
                const title = item.querySelector('strong').textContent.toLowerCase();
                const description = item.querySelector('p:last-of-type').textContent.toLowerCase();
                if (title.includes(filterValue) || description.includes(filterValue)) {
                    item.style.display = 'flex';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        // تحميل الأعمال
        function loadWorks() {
            const data = JSON.parse(localStorage.getItem('cmaData'));
            const worksList = document.getElementById('worksList');
            
            if (worksList) {
                worksList.innerHTML = '';
                data.works.forEach(work => {
                    const service = data.services.find(s => s.id === work.service);
                    const mediaCount = (work.media ? work.media.length : 0) + (work.videos ? work.videos.length : 0);
                    
                    const workElement = document.createElement('div');
                    workElement.className = 'list-item';
                    workElement.innerHTML = `
                        <div>
                            <strong>${work.title}</strong>
                            <p style="color: #666; font-size: 0.9rem;">الخدمة: ${service ? service.name : 'غير محدد'}</p>
                            <p style="color: #666; font-size: 0.9rem;">عدد الوسائط: ${mediaCount}</p>
                            <p style="color: #666; font-size: 0.9rem;">${work.description}</p>
                        </div>
                        <div class="list-item-actions">
                            <button class="view-btn" onclick="viewWorkInDashboard(${work.id})">عرض</button>
                            <button class="edit-btn" onclick="editWork(${work.id})">تعديل</button>
                            <button class="delete-btn" onclick="deleteWork(${work.id})">حذف</button>
                        </div>
                    `;
                    worksList.appendChild(workElement);
                });
            }
        }

        // تحميل الرسائل
        function loadMessages() {
            const data = JSON.parse(localStorage.getItem('cmaData'));
            const messagesList = document.getElementById('messagesList');
            
            if (messagesList) {
                messagesList.innerHTML = '';
                data.messages.forEach(message => {
                    const messageElement = document.createElement('div');
                    messageElement.className = 'list-item';
                    messageElement.style.backgroundColor = message.read ? '#2a2a2a' : '#3a3a3a';
                    messageElement.innerHTML = `
                        <div>
                            <strong>${message.name}</strong>
                            <p style="color: #666; font-size: 0.9rem;">الهاتف: ${message.phone} | البريد: ${message.email}</p>
                            <p style="color: #ddd; margin-top: 0.5rem;">${message.message}</p>
                            <p style="color: #666; font-size: 0.8rem; margin-top: 0.5rem;">${new Date(message.date).toLocaleString('ar-EG')}</p>
                        </div>
                        <div class="list-item-actions">
                            <button class="${message.read ? 'edit-btn' : 'delete-btn'}" onclick="toggleMessageRead(${message.id})">
                                ${message.read ? 'مقروءة' : 'وضع كمقروءة'}
                            </button>
                            <button class="delete-btn" onclick="deleteMessage(${message.id})">حذف</button>
                        </div>
                    `;
                    messagesList.appendChild(messageElement);
                });
            }
        }

        // تحميل طلبات الاستشارة
        function loadConsultations() {
            const data = JSON.parse(localStorage.getItem('cmaData'));
            const consultationsList = document.getElementById('consultationsList');
            
            if (consultationsList) {
                consultationsList.innerHTML = '';
                data.consultations.forEach(consultation => {
                    const consultationElement = document.createElement('div');
                    consultationElement.className = 'list-item';
                    consultationElement.innerHTML = `
                        <div>
                            <strong>${consultation.name}</strong>
                            <p style="color: #666; font-size: 0.9rem;">الهاتف: ${consultation.phone} | البريد: ${consultation.email}</p>
                            <p style="color: #ddd; margin-top: 0.5rem;">الحالة: ${consultation.status}</p>
                            <p style="color: #666; font-size: 0.8rem; margin-top: 0.5rem;">${new Date(consultation.date).toLocaleString('ar-EG')}</p>
                        </div>
                        <div class="list-item-actions">
                            <button class="edit-btn" onclick="updateConsultationStatus(${consultation.id}, 'تم التواصل')">تم التواصل</button>
                            <button class="view-btn" onclick="updateConsultationStatus(${consultation.id}, 'مكتمل')">مكتمل</button>
                            <button class="delete-btn" onclick="deleteConsultation(${consultation.id})">حذف</button>
                        </div>
                    `;
                    consultationsList.appendChild(consultationElement);
                });
            }
        }

        // تحميل بيانات الزوار
        function loadVisitors() {
            const data = JSON.parse(localStorage.getItem('cmaData'));
            const visitorsList = document.getElementById('visitorsList');
            
            if (visitorsList) {
                visitorsList.innerHTML = '';
                data.visitors.forEach(visitor => {
                    const visitorElement = document.createElement('div');
                    visitorElement.className = 'list-item';
                    visitorElement.innerHTML = `
                        <div>
                            <strong>تاريخ: ${visitor.date}</strong>
                            <p style="color: #666; font-size: 0.9rem;">عدد الزيارات: ${visitor.count}</p>
                            <p style="color: #666; font-size: 0.9rem;">آخر زيارة: ${new Date(visitor.lastVisit).toLocaleString('ar-EG')}</p>
                            <p style="color: #666; font-size: 0.8rem;">اللغة: ${visitor.language}</p>
                        </div>
                    `;
                    visitorsList.appendChild(visitorElement);
                });
            }
        }

        // إنشاء الرسوم البيانية
        function createCharts() {
            createWorksChart();
            createVisitorsChart();
        }

        // إنشاء رسم بياني للأعمال
        function createWorksChart() {
            const ctx = document.getElementById('worksChart');
            if (ctx && !worksChart) {
                const data = JSON.parse(localStorage.getItem('cmaData'));
                const servicesData = data.services.map(service => ({
                    service: service.name,
                    count: data.works.filter(work => work.service === service.id).length
                }));
                
                worksChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: servicesData.map(s => s.service),
                        datasets: [{
                            data: servicesData.map(s => s.count),
                            backgroundColor: [
                                '#ffd700',
                                '#d4af37',
                                '#fff8dc',
                                '#ffcc00',
                                '#ffb300',
                                '#f0c040',
                                '#e6b800'
                            ],
                            borderWidth: 2,
                            borderColor: '#1c1c1e'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: {
                                    color: '#ffffff',
                                    font: {
                                        family: 'Poppins',
                                        size: 14
                                    }
                                }
                            }
                        }
                    }
                });
            }
        }

        // إنشاء رسم بياني للزوار
        function createVisitorsChart() {
            const ctx = document.getElementById('visitorsChart');
            if (ctx && !visitorsChart) {
                const data = JSON.parse(localStorage.getItem('cmaData'));
                
                // إنشاء بيانات آخر 7 أيام
                const last7Days = [];
                const visitorCounts = [];
                
                for (let i = 6; i >= 0; i--) {
                    const date = new Date();
                    date.setDate(date.getDate() - i);
                    const dateString = date.toDateString();
                    
                    last7Days.push(date.toLocaleDateString('ar-EG', { weekday: 'short', day: 'numeric' }));
                    
                    const visitor = data.visitors.find(v => v.date === dateString);
                    visitorCounts.push(visitor ? visitor.count : 0);
                }
                
                visitorsChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: last7Days,
                        datasets: [{
                            label: 'الزوار',
                            data: visitorCounts,
                            borderColor: '#ffd700',
                            backgroundColor: 'rgba(255, 215, 0, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: {
                                    color: '#ffffff',
                                    font: {
                                        family: 'Poppins',
                                        size: 14
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    color: '#ffffff'
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            },
                            x: {
                                ticks: {
                                    color: '#ffffff'
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            }
                        }
                    }
                });
            }
        }

        // إضافة رابط فيديو
        function addVideoLink() {
            const input = document.getElementById('videoLinkInput');
            const url = input.value.trim();
            
            if (url) {
                videoLinks.push(url);
                input.value = '';
                updateMediaPreview();
            }
        }

        // تحديث معاينة الوسائط
        function updateMediaPreview() {
            const preview = document.getElementById('mediaPreview');
            preview.innerHTML = '';
            
            // عرض الصور المختارة
            const fileInput = document.getElementById('workImages');
            if (fileInput.files) {
                Array.from(fileInput.files).forEach((file, index) => {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const mediaItem = document.createElement('div');
                        mediaItem.className = 'media-item';
                        mediaItem.innerHTML = `
                            <img src="${e.target.result}" alt="Work Image">
                            <button class="remove-media" onclick="removeImage(${index})">×</button>
                        `;
                        preview.appendChild(mediaItem);
                    };
                    reader.readAsDataURL(file);
                });
            }
            
            // عرض روابط الفيديو
            videoLinks.forEach((link, index) => {
                const mediaItem = document.createElement('div');
                mediaItem.className = 'media-item';
                
                mediaItem.innerHTML = `
                    ${generateEmbedHtml(link)}
                    <button class="remove-media" onclick="removeVideo(${index})">×</button>
                `;
                preview.appendChild(mediaItem);
            });
        }

        // إزالة صورة
        function removeImage(index) {
            const fileInput = document.getElementById('workImages');
            const dt = new DataTransfer();
            
            Array.from(fileInput.files).forEach((file, i) => {
                if (i !== index) {
                    dt.items.add(file);
                }
            });
            
            fileInput.files = dt.files;
            updateMediaPreview();
        }

        // إزالة فيديو
        function removeVideo(index) {
            videoLinks.splice(index, 1);
            updateMediaPreview();
        }

        // معالجة نماذج الداش بورد
        document.getElementById('addServiceForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const serviceImage = document.getElementById('serviceImage').files[0];
            
            if (serviceImage) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const service = {
                        id: 'service-' + Date.now(),
                        name: formData.get('serviceName'),
                        nameEn: formData.get('serviceNameEn'),
                        description: formData.get('serviceDescription'),
                        descriptionEn: formData.get('serviceDescriptionEn'),
                        image: e.target.result
                    };
                    
                    const data = JSON.parse(localStorage.getItem('cmaData'));
                    data.services.push(service);
                    localStorage.setItem('cmaData', JSON.stringify(data));
                    
                    loadServices();
                    updateStats();
                    document.getElementById('addServiceForm').reset();
                    alert('تم إضافة الخدمة بنجاح');
                };
                reader.readAsDataURL(serviceImage);
            }
        });

        document.getElementById('addWorkForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const workImages = document.getElementById('workImages').files;
            
            const workData = {
                service: formData.get('workService'),
                title: formData.get('workTitle'),
                titleEn: formData.get('workTitleEn'),
                description: formData.get('workDescription'),
                descriptionEn: formData.get('workDescriptionEn'),
                videos: [...videoLinks]
            };

            const processAndSave = (imageUrls) => {
                const data = JSON.parse(localStorage.getItem('cmaData'));

                if(currentlyEditingWorkId) {
                    // وضع التعديل
                    const workIndex = data.works.findIndex(w => w.id === currentlyEditingWorkId);
                    if(workIndex !== -1) {
                        const existingWork = data.works[workIndex];
                        data.works[workIndex] = {
                            ...existingWork,
                            ...workData,
                            media: imageUrls.length > 0 ? imageUrls : existingWork.media // الاحتفاظ بالصور القديمة إذا لم يتم تحديد صور جديدة
                        };
                        alert('تم تحديث العمل بنجاح');
                    }
                } else {
                    // وضع الإضافة
                    const newWork = {
                        ...workData,
                        id: Date.now(),
                        media: imageUrls,
                    };
                    data.works.push(newWork);
                    alert('تم إضافة العمل بنجاح');
                }
                
                localStorage.setItem('cmaData', JSON.stringify(data));
                
                loadWorks();
                updateStats();
                cancelEditWork(); // لإعادة تعيين النموذج
                
                if (worksChart) {
                    worksChart.destroy();
                    worksChart = null;
                    createWorksChart();
                }
            };

            if (workImages.length > 0) {
                let processedImages = 0;
                let imageUrls = [];
                Array.from(workImages).forEach(image => {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        imageUrls.push(e.target.result);
                        processedImages++;
                        if (processedImages === workImages.length) {
                            processAndSave(imageUrls);
                        }
                    };
                    reader.readAsDataURL(image);
                });
            } else {
                processAndSave([]);
            }
        });
        
        document.getElementById('changePasswordForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            if (currentPassword !== currentUser.password) {
                alert('كلمة المرور الحالية غير صحيحة');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                alert('كلمة المرور الجديدة غير متطابقة');
                return;
            }
            
            const data = JSON.parse(localStorage.getItem('cmaData'));
            const userIndex = data.users.findIndex(u => u.username === currentUser.username);
            data.users[userIndex].password = newPassword;
            localStorage.setItem('cmaData', JSON.stringify(data));
            
            currentUser.password = newPassword;
            document.getElementById('changePasswordForm').reset();
            alert('تم تغيير كلمة المرور بنجاح');
        });

        // مراقبة تغيير الملفات
        document.getElementById('workImages').addEventListener('change', updateMediaPreview);

        // وظائف الحذف والتعديل
        function deleteService(serviceId) {
            if (confirm('هل أنت متأكد من حذف هذه الخدمة؟ سيتم حذف جميع الأعمال المرتبطة بها.')) {
                const data = JSON.parse(localStorage.getItem('cmaData'));
                data.services = data.services.filter(s => s.id !== serviceId);
                data.works = data.works.filter(w => w.service !== serviceId);
                localStorage.setItem('cmaData', JSON.stringify(data));
                
                loadServices();
                loadWorks();
                updateStats();
            }
        }

        function deleteWork(workId) {
            if (confirm('هل أنت متأكد من حذف هذا العمل؟')) {
                const data = JSON.parse(localStorage.getItem('cmaData'));
                data.works = data.works.filter(w => w.id !== workId);
                localStorage.setItem('cmaData', JSON.stringify(data));
                
                loadWorks();
                updateStats();
                if (worksChart) {
                    worksChart.destroy();
                    worksChart = null;
                    createWorksChart();
                }
            }
        }

        function deleteMessage(messageId) {
            if (confirm('هل أنت متأكد من حذف هذه الرسالة؟')) {
                const data = JSON.parse(localStorage.getItem('cmaData'));
                data.messages = data.messages.filter(m => m.id !== messageId);
                localStorage.setItem('cmaData', JSON.stringify(data));
                
                loadMessages();
                updateStats();
            }
        }

        function deleteConsultation(consultationId) {
            if (confirm('هل أنت متأكد من حذف طلب الاستشارة؟')) {
                const data = JSON.parse(localStorage.getItem('cmaData'));
                data.consultations = data.consultations.filter(c => c.id !== consultationId);
                localStorage.setItem('cmaData', JSON.stringify(data));
                
                loadConsultations();
                updateStats();
            }
        }

        function toggleMessageRead(messageId) {
            const data = JSON.parse(localStorage.getItem('cmaData'));
            const message = data.messages.find(m => m.id === messageId);
            if (message) {
                message.read = !message.read;
                localStorage.setItem('cmaData', JSON.stringify(data));
                loadMessages();
                updateStats();
            }
        }

        function updateConsultationStatus(consultationId, newStatus) {
            const data = JSON.parse(localStorage.getItem('cmaData'));
            const consultation = data.consultations.find(c => c.id === consultationId);
            if (consultation) {
                consultation.status = newStatus;
                localStorage.setItem('cmaData', JSON.stringify(data));
                loadConsultations();
            }
        }

        // تهيئة النظام عند تحميل الصفحة
        document.addEventListener('DOMContentLoaded', function() {
            initializeSystem();
            
            // التحقق من معاملات URL
            if (window.location.search.includes('submitted=true')) {
                document.getElementById('thankYouPopup').style.display = 'flex';
                const url = new URL(window.location);
                url.searchParams.delete('submitted');
                window.history.replaceState({}, document.title, url.toString());
            }

            // معالج نموذج الاستشارة
            const consultationForm = document.getElementById('consultationForm');
            if (consultationForm) {
                consultationForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const form = e.target;
                    const name = form.elements.consultationName.value;
                    const phone = form.elements.consultationPhone.value;
                    const email = form.elements.consultationEmail.value;

                    if (name && phone && email) {
                        const consultation = {
                            id: Date.now(),
                            name: name,
                            phone: phone,
                            email: email,
                            date: new Date().toISOString(),
                            status: 'جديد'
                        };

                        const data = JSON.parse(localStorage.getItem('cmaData'));
                        data.consultations.push(consultation);
                        localStorage.setItem('cmaData', JSON.stringify(data));

                        sendConsultationEmail(consultation);

                        localStorage.setItem('consultationRequested', 'true');
                        closeConsultationPopup();

                        alert(currentLanguage === 'ar' ?
                            'تم طلب الاستشارة بنجاح! سنتواصل معك قريباً.' :
                            'Consultation requested successfully! We will contact you soon.');

                        updateStats();
                        form.reset();
                    }
                });
            }
        });

        // معالجة أحداث لوحة المفاتيح للمعرض
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('projectDetailPage').classList.contains('active')) {
                if (e.key === 'ArrowLeft') {
                    changeSlide(-1);
                } else if (e.key === 'ArrowRight') {
                    changeSlide(1);
                } else if (e.key === 'Escape') {
                    backToService();
                }
            }
        });

        // دعم التمرير باللمس للمعرض
        let touchStartX = 0;
        let touchEndX = 0;

        document.getElementById('projectGallery').addEventListener('touchstart', function(e) {
            touchStartX = e.changedTouches[0].screenX;
        });

        document.getElementById('projectGallery').addEventListener('touchend', function(e) {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        });

        function handleSwipe() {
            const swipeThreshold = 50;
            const diff = touchStartX - touchEndX;
            
            if (Math.abs(diff) > swipeThreshold) {
                if (diff > 0) {
                    changeSlide(1); // تمرير لليسار
                } else {
                    changeSlide(-1); // تمرير لليمين
                }
            }
        }
    </script>
</body>
</html>